<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        .red {
            color: red;
        }
        
        .search {
            width: 300px;
            margin: 20px 0;
        }
    </style>
</head>

<body>
    <div id="app">
        <div class="container">

            <!-- ÊêúÁ¥¢ -->
            <input v-model.trim='key' type="text" class="form-control search" placeholder="ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠ó">

            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th>ÁºñÂè∑</th>
                        <th>ËµÑ‰∫ßÂêçÁß∞</th>
                        <th>‰ª∑Ê†º</th>
                        <th>Êìç‰Ωú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(item, index) in showList" :key="item.id">
                        <td>{{ index+1 }}</td>
                        <td>{{ item.name}}</td>
                        <td>üí¥{{ item.price }}</td>
                        <td><a @click="del(item.id)" href="javascript:;">Âà†Èô§</a></td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="4">ËµÑ‰∫ßÊÄª‰ª∑:{{total}}ÂÖÉ</td>
                    </tr>
                </tfoot>
            </table>

            <!-- Ê∑ªÂä†ËµÑ‰∫ß -->
            <form class="form-inline">
                <div class="form-group">
                    <div class="input-group">
                        <input v-model.trim="name" type="text" class="form-control" placeholder="ËµÑ‰∫ßÂêçÁß∞" />
                    </div>
                    &nbsp;&nbsp;
                    <div class="input-group">
                        <input v-model.trim.number="price" type="text" class="form-control" placeholder="ËµÑ‰∫ß‰ª∑Ê†º" />
                    </div>
                </div>
                &nbsp;&nbsp;
                <!-- buttonÈªòËÆ§ÊòØ‰ºöÊèê‰∫§formË°®Âçï, ÈòªÊ≠¢ÈªòËÆ§Ë°å‰∏∫ -->
                <button @click.prevent="add" class="btn btn-primary">Ê∑ªÂä†ËµÑ‰∫ß</button>
            </form>
        </div>
    </div>
    <script src="../node_modules/axios/dist/axios.js"></script>
    <script src="../vue.js"></script>
    <script>
        // 1. ËøõË°åvueÂÆû‰æãÂåñ, ‰ΩÜÊòØlistÊï∞ÁªÑÂàùÂßãÂåñ‰∏∫ [], Êï∞ÊçÆÂ∫îËØ•ÂêéÂè∞ËØ∑Ê±ÇÂõûÊù•ÁöÑ
        //    ÈóÆÈ¢ò: Âú®Âì™ÂèëÈÄÅËØ∑Ê±Ç? Âú®vue‰∏≠Âèë, ‰∏ÄËà¨ËøôÁßçÂàùÂßãÂåñÁöÑajaxËØ∑Ê±Ç, ‰ºöÂú®vue‰∏≠ created‰∏≠ÂèëÈÄÅ
        //    createdÊòØ‰∏Ä‰∏™ÂáΩÊï∞ (ÁîüÂëΩÂë®ÊúüÂáΩÊï∞) Âú®ÁâπÂÆöÁöÑÈò∂ÊÆµ, Ë¢´vueËá™Âä®Ë∞ÉÁî®ÊâßË°å
        //    createdÂú®vueÂÆû‰æãÂàõÂª∫Âá∫Êù•, dataÊï∞ÊçÆ‰πüÂü∫Êú¨ÂàùÂßãÂåñÂ•ΩÊó∂, ‰ºöËá™Âä®Ë∞ÉÁî®, ÈÄÇÂêàÂú®ËøôÈáåÂèëÈÄÅÂàùÂßãÂåñÁöÑajaxËØ∑Ê±Ç
        // 2. ÂèëÈÄÅËØ∑Ê±Ç
        //    axios, Âú®created‰∏≠Âèë
        // 3. Ê∏≤Êüì
        //    v-for
        // 4. Âà†Èô§
        // (1) ÁÇπÂáª‰∫ã‰ª∂ @click
        // (2) ÁÇπÂáªÊó∂Ë¶Å‰º† id
        // (3) Êé•Êî∂Âà∞, Ê†πÊçÆ id, ÂèëÈÄÅÂà†Èô§ÁöÑËØ∑Ê±Ç‰∫Ü
        // (4) Âà†Èô§, Âà†Èô§ÁöÑÊòØÂêéÂè∞ÁöÑÊï∞ÊçÆ, ÈúÄË¶ÅÈáçÊñ∞Ê∏≤Êüì, Â∞±ÈúÄË¶ÅÂ∞ÜÊ∏≤ÊüìÁöÑÂáΩÊï∞ËøõË°åÂ∞ÅË£Ö
        // 5. Ê∑ªÂä†
        // (1) v-modelÁªëÂÆö‰∏§‰∏™ËæìÂÖ•Ê°ÜÁöÑÂÄº, ‰æø‰∫éËé∑Âèñ
        // (2) Ê≥®ÂÜåÁÇπÂáª‰∫ã‰ª∂, ÈòªÊ≠¢ÈªòËÆ§ÁöÑË°å‰∏∫ .prevent
        // (3) ÂèëÈÄÅÊ∑ªÂä†ÁöÑËØ∑Ê±Ç‰∫Ü post
        // (4) ÈáçÊñ∞Ê∏≤Êüì

        // 6. ÊêúÁ¥¢
        // (1) Ëé∑ÂèñÊêúÁ¥¢Ê°ÜÁöÑÂÄº v-modelÁªëÂÆö
        // (2) Âü∫‰∫éÁé∞ÊúâÁöÑÊï∞ÊçÆ, Ê†πÊçÆÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠ó, ËøáÊª§Âô®Â±ïÁ§∫
        //     ÂáÜÂ§á‰∏Ä‰∏™showListËÆ°ÁÆóÂ±ûÊÄß


        const vm = new Vue({
            el: "#app",
            data: {
                list: [],
                name: '',
                price: 0,
                key: ''
            },
            created() {
                // 
                this.getList()
            },
            methods: {
                getList() {
                    axios.get('http://localhost:3000/list').then(res => {
                        this.list = res.data
                    })
                },
                del(id) {
                    axios.delete(`http://localhost:3000/list/${id}`).then(res => {
                        this.getList()
                    })
                },
                add() {
                    if (this.name === '') return
                    if (this.price === '' || this.price <= 0) return
                    axios.post('http://localhost:3000/list', {
                        name: this.name,
                        price: this.price
                    }).then(res => {
                        this.getList()
                        this.name = ''
                        this.price = ''
                    })
                }
            },
            computed: {
                showList() {
                    return this.list.filter(item => item.name.includes(this.key))
                },
                total() {
                    let sum = 0
                    this.showList.forEach(item => sum += item.price)
                    return sum
                }
            }
        })
    </script>
</body>

</html>